<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>CFTime class — CFTime • CFtime</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="CFTime class — CFTime"><meta name="description" content='This class manages the "time" dimension of netCDF files that
follow the CF Metadata Conventions, and its productive use in R.
The class has a field cal which holds a specific calendar from the
allowed types (all named calendars are supported). The calendar is
also implemented as a (hidden) class which converts netCDF file encodings to
timestamps as character strings, and vice-versa. Bounds information (the
period of time over which a timestamp is valid) is used when defined in the
netCDF file.
Additionally, this class has functions to ease use of the netCDF "time"
information when processing data from netCDF files. Filtering and indexing of
time values is supported, as is the generation of factors.'><meta property="og:description" content='This class manages the "time" dimension of netCDF files that
follow the CF Metadata Conventions, and its productive use in R.
The class has a field cal which holds a specific calendar from the
allowed types (all named calendars are supported). The calendar is
also implemented as a (hidden) class which converts netCDF file encodings to
timestamps as character strings, and vice-versa. Bounds information (the
period of time over which a timestamp is valid) is used when defined in the
netCDF file.
Additionally, this class has functions to ease use of the netCDF "time"
information when processing data from netCDF files. Filtering and indexing of
time values is supported, as is the generation of factors.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CFtime</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/cftime.html">Working with CFtime</a></li>
    <li><a class="dropdown-item" href="../articles/conformance.html">Conformance with the CF Metadata Conventions</a></li>
    <li><a class="dropdown-item" href="../articles/processing.html">Processing climate projection data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-CF/CFtime/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>CFTime class</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-CF/CFtime/blob/main/R/CFtime.R" class="external-link"><code>R/CFtime.R</code></a></small>
      <div class="d-none name"><code>CFtime.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This class manages the "time" dimension of netCDF files that
follow the CF Metadata Conventions, and its productive use in R.</p>
<p>The class has a field <code>cal</code> which holds a specific calendar from the
allowed types (all named calendars are supported). The calendar is
also implemented as a (hidden) class which converts netCDF file encodings to
timestamps as character strings, and vice-versa. Bounds information (the
period of time over which a timestamp is valid) is used when defined in the
netCDF file.</p>
<p>Additionally, this class has functions to ease use of the netCDF "time"
information when processing data from netCDF files. Filtering and indexing of
time values is supported, as is the generation of factors.</p>
    </div>


    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>https://cfconventions.org/Data/cf-conventions/cf-conventions-1.12/cf-conventions.html#time-coordinate</p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>cal</code></dt>
<dd><p>The calendar of this <code>CFTime</code> instance, a descendant of the
<a href="CFCalendar.html">CFCalendar</a> class.</p></dd>


<dt><code>offsets</code></dt>
<dd><p>A numeric vector of offsets from the origin of the
calendar.</p></dd>


<dt><code>resolution</code></dt>
<dd><p>The average number of time units between offsets.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="active-bindings">Active bindings<a class="anchor" aria-label="anchor" href="#active-bindings"></a></h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>calendar</code></dt>
<dd><p>(read-only) The calendar of this <code>CFTime</code> instance, a
descendant of the <a href="CFCalendar.html">CFCalendar</a> class.</p></dd>


<dt><code>unit</code></dt>
<dd><p>(read-only) The unit string of the calendar and time series.</p></dd>


<dt><code>length</code></dt>
<dd><p>(read-only) Retrieve the number of offsets in the time
series.</p></dd>


<dt><code>bounds</code></dt>
<dd><p>Retrieve or set the bounds for the offsets. On setting, a
<code>matrix</code> with columns for <code>offsets</code> and low values in the first row,
high values in the second row. This may be simply <code>TRUE</code> to set regular
and consecutive bounds.</p></dd>


<dt><code>friendlyClassName</code></dt>
<dd><p>Character string with class name for display
purposes.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-CFTime-new"><code>CFTime$new()</code></a></p></li>
<li><p><a href="#method-CFTime-print"><code>CFTime$print()</code></a></p></li>
<li><p><a href="#method-CFTime-range"><code>CFTime$range()</code></a></p></li>
<li><p><a href="#method-CFTime-as_timestamp"><code>CFTime$as_timestamp()</code></a></p></li>
<li><p><a href="#method-CFTime-format"><code>CFTime$format()</code></a></p></li>
<li><p><a href="#method-CFTime-indexOf"><code>CFTime$indexOf()</code></a></p></li>
<li><p><a href="#method-CFTime-get_bounds"><code>CFTime$get_bounds()</code></a></p></li>
<li><p><a href="#method-CFTime-set_bounds"><code>CFTime$set_bounds()</code></a></p></li>
<li><p><a href="#method-CFTime-equidistant"><code>CFTime$equidistant()</code></a></p></li>
<li><p><a href="#method-CFTime-slice"><code>CFTime$slice()</code></a></p></li>
<li><p><a href="#method-CFTime-POSIX_compatible"><code>CFTime$POSIX_compatible()</code></a></p></li>
<li><p><a href="#method-CFTime-cut"><code>CFTime$cut()</code></a></p></li>
<li><p><a href="#method-CFTime-factor"><code>CFTime$factor()</code></a></p></li>
<li><p><a href="#method-CFTime-factor_units"><code>CFTime$factor_units()</code></a></p></li>
<li><p><a href="#method-CFTime-factor_coverage"><code>CFTime$factor_coverage()</code></a></p></li>
<li><p><a href="#method-CFTime-copy"><code>CFTime$copy()</code></a></p></li>
<li><p><a href="#method-CFTime-subset"><code>CFTime$subset()</code></a></p></li>
<li><p><a href="#method-CFTime-clone"><code>CFTime$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-CFTime-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create a new instance of this class.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/CFtime.html">CFTime</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">definition</span>, calendar <span class="op">=</span> <span class="st">"standard"</span>, offsets <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>definition</code></dt>
<dd><p>Character string of the units and origin of the
calendar.</p></dd>


<dt><code>calendar</code></dt>
<dd><p>Character string of the calendar to use. Must be one of
the values permitted by the CF Metadata Conventions. If <code>NULL</code>, the
"standard" calendar will be used.</p></dd>


<dt><code>offsets</code></dt>
<dd><p>Numeric or character vector, optional. When numeric, a
vector of offsets from the origin in the time series. When a character
vector of length 2 or more, timestamps in ISO8601 or UDUNITS format.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-CFTime-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>Print a summary of the <code>CFTime</code> object to the console.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Ignored.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>Self, invisibly.</p>
</div>

</div><p></p><hr><a id="method-CFTime-range"></a><div class="section">
<h3 id="method-range-">Method <code><a href="https://rdrr.io/r/base/range.html" class="external-link">range()</a></code><a class="anchor" aria-label="anchor" href="#method-range-"></a></h3>
<p>This method returns the first and last timestamp of the time
series as a vector. Note that the offsets do not have to be sorted.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">range</span><span class="op">(</span>format <span class="op">=</span> <span class="st">""</span>, bounds <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>format</code></dt>
<dd><p>Value of "date" or "timestamp". Optionally, a
character string that specifies an alternate format.</p></dd>


<dt><code>bounds</code></dt>
<dd><p>Logical to indicate if the extremes from the bounds should
be used, if set. Defaults to <code>FALSE</code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>Vector of two character strings that represent the starting and
ending timestamps in the time series. If a <code>format</code> is supplied, that
format will be used. Otherwise, if all of the timestamps in the time
series have a time component of <code>00:00:00</code> the date of the timestamp is
returned, otherwise the full timestamp (without any time zone
information).</p>
</div>

</div><p></p><hr><a id="method-CFTime-as_timestamp"></a><div class="section">
<h3 id="method-as-timestamp-">Method <code><a href="as_timestamp.html">as_timestamp()</a></code><a class="anchor" aria-label="anchor" href="#method-as-timestamp-"></a></h3>
<p>This method generates a vector of character strings or
<code>POSIXct</code>s that represent the date and time in a selectable combination
for each offset.</p>
<p>The character strings use the format <code>YYYY-MM-DDThh:mm:ss±hhmm</code>,
depending on the <code>format</code> specifier. The date in the string is not
necessarily compatible with <code>POSIXt</code> - in the <code>360_day</code> calendar
<code>2017-02-30</code> is valid and <code>2017-03-31</code> is not.</p>
<p>For the "proleptic_gregorian" calendar the output can also be generated
as a vector of <code>POSIXct</code> values by specifying <code>asPOSIX = TRUE</code>. The
same is possible for the "standard" and "gregorian" calendars but only
if all timestamps fall on or after 1582-10-15. If <code>asPOSIX = TRUE</code> is
specified while the calendar does not support it, an error will be
generated.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">as_timestamp</span><span class="op">(</span>format <span class="op">=</span> <span class="cn">NULL</span>, asPOSIX <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>format</code></dt>
<dd><p>character. A character string with either of the values
"date" or "timestamp". If the argument is not specified, the format
used is "timestamp" if there is time information, "date" otherwise.</p></dd>


<dt><code>asPOSIX</code></dt>
<dd><p>logical. If <code>TRUE</code>, for "standard", "gregorian" and
"proleptic_gregorian" calendars the output is a vector of <code>POSIXct</code> -
for other calendars an error will be thrown. Default value is <code>FALSE</code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>A character vector where each element represents a moment in
time according to the <code>format</code> specifier.</p>
</div>

</div><p></p><hr><a id="method-CFTime-format"></a><div class="section">
<h3 id="method-format-">Method <code><a href="https://rdrr.io/r/base/format.html" class="external-link">format()</a></code><a class="anchor" aria-label="anchor" href="#method-format-"></a></h3>
<p>Format timestamps using a specific format string, using the
specifiers defined for the <code><a href="https://rdrr.io/r/base/strptime.html" class="external-link">base::strptime()</a></code> function, with
limitations. The only supported specifiers are <code>bBdeFhHImMpRSTYz%</code>.
Modifiers <code>E</code> and <code>O</code> are silently ignored. Other specifiers, including
their percent sign, are copied to the output as if they were adorning
text.</p>
<p>The formatting is largely oblivious to locale. The reason for this is
that certain dates in certain calendars are not POSIX-compliant and the
system functions necessary for locale information thus do not work
consistently. The main exception to this is the (abbreviated) names of
months (<code>bB</code>), which could be useful for pretty printing in the local
language. For separators and other locale-specific adornments, use
local knowledge instead of depending on system locale settings; e.g.
specify <code>%m/%d/%Y</code> instead of <code>%D</code>.</p>
<p>Week information, including weekday names, is not supported at all as a
"week" is not defined for non-standard CF calendars and not generally
useful for climate projection data. If you are working with observed
data and want to get pretty week formats, use the <code><a href="as_timestamp.html">as_timestamp()</a></code>
method to generate <code>POSIXct</code> timestamps (observed data generally uses a
"standard" calendar) and then use the <code><a href="https://rdrr.io/r/base/format.html" class="external-link">base::format()</a></code> function which
supports the full set of specifiers.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">format</span><span class="op">(</span><span class="va">format</span>, usetz <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>format</code></dt>
<dd><p>A character string with <code>strptime</code> format specifiers. If
omitted, the most economical format will be used: a full timestamp when
time information is available, a date otherwise.</p></dd>


<dt><code>usetz</code></dt>
<dd><p>Logical. Should the time zone offset be appended to the
output? This is always in numerical form, i.e. "-0800", from UTC.
Default is <code>FALSE</code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>A vector of character strings with a properly formatted
timestamp. Any format specifiers not recognized or supported will be
returned verbatim.</p>
</div>

</div><p></p><hr><a id="method-CFTime-indexOf"></a><div class="section">
<h3 id="method-indexof-">Method <code><a href="indexOf.html">indexOf()</a></code><a class="anchor" aria-label="anchor" href="#method-indexof-"></a></h3>
<p>Find the index in the time series for each timestamp given
in argument <code>x</code>. Alternatively, when <code>x</code> is a numeric vector of index
values, return the valid indices of the same vector, with the side
effect being the attribute "CFTime" associated with the result.</p>
<p>Matching also returns index values for timestamps that fall between two
elements of the time series - this can lead to surprising results when
time series elements are positioned in the middle of an interval (as
the CF Metadata Conventions instruct us to "reasonably assume"): a time
series of days in January would be encoded in a netCDF file as
<code>c("2024-01-01 12:00:00", "2024-01-02 12:00:00", "2024-01-03 12:00:00", ...)</code> so <code>x &lt;- c("2024-01-01", "2024-01-02", "2024-01-03")</code> would
result in <code>(NA, 1, 2)</code> (or <code>(NA, 1.5, 2.5)</code> with <code>method = "linear"</code>)
because the date values in <code>x</code> are at midnight. This situation is
easily avoided by ensuring that this <code>CFTime</code> instance has bounds set
(use <code>bounds(y) &lt;- TRUE</code> as a proximate solution if bounds are not
stored in the netCDF file).</p>
<p>If bounds are set, the indices are informed by those bounds. If the
bounds are not contiguous, returned values may be <code>NA</code> even if the
value of <code>x</code> falls between two valid timestamps.</p>
<p>Values of <code>x</code> that are not valid timestamps according to the calendar
of this <code>CFTime</code> instance will be returned as <code>NA</code>.</p>
<p>Argument <code>x</code> can also be a numeric vector of index values, in which
case the valid values in <code>x</code> are returned. If negative values are
passed, the positive counterparts will be excluded and then the
remainder returned. Positive and negative values may not be mixed.
Using a numeric vector has the side effect that the result has the
attribute "CFTime" describing the temporal dimension of the slice. If
index values outside of the range of <code>self</code> are provided, an error will
be thrown.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">indexOf</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"constant"</span>, rightmost.closed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>x</code></dt>
<dd><p>Vector of <code>character</code>, <code>POSIXt</code> or <code>Date</code> values to find indices
for, or a <code>numeric</code> vector.</p></dd>


<dt><code>method</code></dt>
<dd><p>Single value of "constant" or "linear". If <code>"constant"</code>,
return the index value for each match. If <code>"linear"</code>, return the index
value with any fractional value.</p></dd>


<dt><code>rightmost.closed</code></dt>
<dd><p>Whether or not to include the upper limit of
argument <code>x</code>. Default is <code>FALSE</code>. This argument is ignored when
argument <code>x</code> contains index values.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>A numeric vector giving indices into <code>self</code> for the values of
<code>x</code>. If there is at least 1 valid index, then attribute "CFTime"
contains an instance of <code>CFTime</code> that describes the dimension of
filtering the dataset associated with <code>self</code> with the result of this
method, excluding any <code>NA</code> values.</p>
</div>

</div><p></p><hr><a id="method-CFTime-get_bounds"></a><div class="section">
<h3 id="method-get-bounds-">Method <code>get_bounds()</code><a class="anchor" aria-label="anchor" href="#method-get-bounds-"></a></h3>
<p>Return boundary values.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">get_bounds</span><span class="op">(</span><span class="va">format</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>format</code></dt>
<dd><p>A string specifying a format for output, optional.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a></h4>
<p>An array with <code>dims(2, length(offsets))</code> with values for the
boundaries. <code>NULL</code> if the boundaries have not been set.</p>
</div>

</div><p></p><hr><a id="method-CFTime-set_bounds"></a><div class="section">
<h3 id="method-set-bounds-">Method <code>set_bounds()</code><a class="anchor" aria-label="anchor" href="#method-set-bounds-"></a></h3>
<p>Set or delete the boundary values of the <code>CFTime</code> instance.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">set_bounds</span><span class="op">(</span><span class="va">value</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>value</code></dt>
<dd><p>The boundary values to set, in units of the offsets. A
matrix <code>(2, length(self$offsets))</code>. If <code>NULL</code>, the boundaries are
deleted. If <code>TRUE</code>, make regular, consecutive boundaries.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a></h4>
<p>Self, invisibly.</p>
</div>

</div><p></p><hr><a id="method-CFTime-equidistant"></a><div class="section">
<h3 id="method-equidistant-">Method <code>equidistant()</code><a class="anchor" aria-label="anchor" href="#method-equidistant-"></a></h3>
<p>This method returns <code>TRUE</code> if the time series has uniformly
distributed time steps between the extreme values, <code>FALSE</code> otherwise.
First test without sorting; this should work for most data sets. If
not, only then offsets are sorted. For most data sets that will work
but for implied resolutions of month, season, year, etc based on a
"days" or finer calendar unit this will fail due to the fact that those
coarser units have a variable number of days per time step, in all
calendars except for <code>360_day</code>. For now, an approximate solution is
used that should work in all but the most non-conformal exotic
arrangements.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">equidistant</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-7">Returns<a class="anchor" aria-label="anchor" href="#returns-7"></a></h4>
<p><code>TRUE</code> if all time steps are equidistant, <code>FALSE</code> otherwise, or
<code>NA</code> if no offsets have been set.</p>
</div>

</div><p></p><hr><a id="method-CFTime-slice"></a><div class="section">
<h3 id="method-slice-">Method <code><a href="slice.html">slice()</a></code><a class="anchor" aria-label="anchor" href="#method-slice-"></a></h3>
<p>Given a vector of character timestamps, return a logical
vector of a length equal to the number of time steps in the time series
with values <code>TRUE</code> for those time steps that fall between the two
extreme values of the vector values, <code>FALSE</code> otherwise.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">slice</span><span class="op">(</span><span class="va">extremes</span>, closed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>extremes</code></dt>
<dd><p>Character vector of timestamps that represent the
time period of interest. The extreme values are selected. Badly
formatted timestamps are silently dropped.</p></dd>


<dt><code>closed</code></dt>
<dd><p>Is the right side closed, i.e. included in the result?
Default is <code>FALSE</code>. A specification of <code>c("2022-01-01", "2023-01-01)</code>
will thus include all time steps that fall in the year 2022 when
<code>closed = FALSE</code> but include <code>2023-01-01</code> if that exact value is
present in the time series.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-8">Returns<a class="anchor" aria-label="anchor" href="#returns-8"></a></h4>
<p>A logical vector with a length equal to the number of time steps
in <code>self</code> with values <code>TRUE</code> for those time steps that fall between the
extreme values, <code>FALSE</code> otherwise.</p>
<p>An attribute 'CFTime' will have the same definition as <code>self</code> but with
offsets corresponding to the time steps falling between the two
extremes. If there are no values between the extremes, the attribute is
not set.</p>
</div>

</div><p></p><hr><a id="method-CFTime-POSIX_compatible"></a><div class="section">
<h3 id="method-posix-compatible-">Method <code>POSIX_compatible()</code><a class="anchor" aria-label="anchor" href="#method-posix-compatible-"></a></h3>
<p>Can the time series be converted to POSIXt?</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">POSIX_compatible</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-9">Returns<a class="anchor" aria-label="anchor" href="#returns-9"></a></h4>
<p><code>TRUE</code> if the calendar support conversion to POSIXt, <code>FALSE</code>
otherwise.</p>
</div>

</div><p></p><hr><a id="method-CFTime-cut"></a><div class="section">
<h3 id="method-cut-">Method <code><a href="cut.CFTime.html">cut()</a></code><a class="anchor" aria-label="anchor" href="#method-cut-"></a></h3>
<p>Create a factor for a <code>CFTime</code> instance.</p>
<p>When argument <code>breaks</code> is one of <code>"year", "season", "quarter", "month", "dekad", "day"</code>, a factor is generated like by <code><a href="CFfactor.html">CFfactor()</a></code>. When
<code>breaks</code> is a vector of character timestamps a factor is produced with
a level for every interval between timestamps. The last timestamp,
therefore, is only used to close the interval started by the
pen-ultimate timestamp - use a distant timestamp (e.g. <code>range(x)[2]</code>)
to ensure that all offsets to the end of the CFTime time series are
included, if so desired. The last timestamp will become the upper bound
in the <code>CFTime</code> instance that is returned as an attribute to this
function so a sensible value for the last timestamp is advisable.</p>
<p>This method works similar to <code><a href="https://rdrr.io/r/base/cut.POSIXt.html" class="external-link">base::cut.POSIXt()</a></code> but there are some
differences in the arguments: for <code>breaks</code> the set of options is
different and no preceding integer is allowed, <code>labels</code> are always
assigned using values of <code>breaks</code>, and the interval is always
left-closed.</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">cut</span><span class="op">(</span><span class="va">breaks</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>breaks</code></dt>
<dd><p>A character string of a factor period (see <code><a href="CFfactor.html">CFfactor()</a></code> for
a description), or a character vector of timestamps that conform to the
calendar of <code>x</code>, with a length of at least 2. Timestamps must be given
in ISO8601 format, e.g. "2024-04-10 21:31:43".</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-10">Returns<a class="anchor" aria-label="anchor" href="#returns-10"></a></h4>
<p>A factor with levels according to the <code>breaks</code> argument, with
attributes 'period', 'era' and 'CFTime'. When <code>breaks</code> is a factor
period, attribute 'period' has that value, otherwise it is '"day"'.
When <code>breaks</code> is a character vector of timestamps, attribute 'CFTime'
holds an instance of <code>CFTime</code> that has the same definition as <code>x</code>, but
with (ordered) offsets generated from the <code>breaks</code>. Attribute 'era'
is always -1.</p>
</div>

</div><p></p><hr><a id="method-CFTime-factor"></a><div class="section">
<h3 id="method-factor-">Method <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code><a class="anchor" aria-label="anchor" href="#method-factor-"></a></h3>
<p>Generate a factor for the offsets, or a part thereof. This
is specifically interesting for creating factors from the date part of
the time series that aggregate the time series into longer time periods
(such as month) that can then be used to process daily CF data sets
using, for instance, <code><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply()</a></code>.</p>
<p>The factor will respect the calendar that the time series is built on.</p>
<p>The factor will be generated in the order of the offsets. While typical
CF-compliant data sources use ordered time series there is, however, no
guarantee that the factor is ordered. For most processing with a factor
the ordering is of no concern.</p>
<p>If the <code>era</code> parameter is specified, either as a vector of years to
include in the factor, or as a list of such vectors, the factor will
only consider those values in the time series that fall within the list
of years, inclusive of boundary values. Other values in the factor will
be set to <code>NA</code>.</p>
<p>The following periods are supported by this method:</p>
<ul><li><p><code>year</code>, the year of each offset is returned as "YYYY".</p></li>
<li><p><code>season</code>, the meteorological season of each offset is returned as
"Sx", with x being 1-4, preceeded by "YYYY" if no <code>era</code> is
specified. Note that December dates are labeled as belonging to the
subsequent year, so the date "2020-12-01" yields "2021S1". This implies
that for standard CMIP files having one or more full years of data the
first season will have data for the first two months (January and
February), while the final season will have only a single month of data
(December).</p></li>
<li><p><code>quarter</code>, the calendar quarter of each offset is returned as "Qx",
with x being 1-4, preceeded by "YYYY" if no <code>era</code> is specified.</p></li>
<li><p><code>month</code>, the month of each offset is returned as "01" to
"12", preceeded by "YYYY-" if no <code>era</code> is specified. This is the default
period.</p></li>
<li><p><code>dekad</code>, ten-day periods are returned as
"Dxx", where xx runs from "01" to "36", preceeded by "YYYY" if no <code>era</code>
is specified. Each month is subdivided in dekads as follows: 1- days 01 -
10; 2- days 11 - 20; 3- remainder of the month.</p></li>
<li><p><code>day</code>, the month and day of each offset are returned as "MM-DD",
preceeded by "YYYY-" if no <code>era</code> is specified.</p></li>
</ul><p>It is not possible to create a factor for a period that is shorter than
the temporal resolution of the calendar. As an example, if the calendar
has a monthly unit, a dekad or day factor cannot be created.</p>
<p>Creating factors for other periods is not supported by this method.
Factors based on the timestamp information and not dependent on the
calendar can trivially be constructed from the output of the
<code><a href="as_timestamp.html">as_timestamp()</a></code> function.</p>
<p>Attribute 'CFTime' of the result contains a <code>CFTime</code> instance that is
valid for the result of applying the factor to a resource that this
instance is associated with. In other words, if <code>CFTime</code> instance 'At'
describes the temporal dimension of resource 'A' and a factor 'Af' is
generated from <code>Af &lt;- At$factor()</code>, then <code>Bt &lt;- attr(Af, "CFTime")</code>
describes the temporal dimension of the result of, say, <code>B &lt;- apply(A, 1:2, tapply, Af, FUN)</code>. The 'CFTime' attribute contains a
<a href="CFClimatology.html">CFClimatology</a> instance for era factors.</p><div class="section">
<h4 id="usage-12">Usage<a class="anchor" aria-label="anchor" href="#usage-12"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">factor</span><span class="op">(</span>period <span class="op">=</span> <span class="st">"month"</span>, era <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-10">Arguments<a class="anchor" aria-label="anchor" href="#arguments-10"></a></h4>
<p></p><div class="arguments"><dl><dt><code>period</code></dt>
<dd><p>character. A character string with one of the values
"year", "season", "quarter", "month" (the default), "dekad" or "day".</p></dd>


<dt><code>era</code></dt>
<dd><p>numeric or list, optional. Vector of years for which to
construct the factor, or a list whose elements are each a vector of
years. The extreme values of the supplied vector will be used. Note
that if a single year is specified that the result is valid, but not a
climatological statistic. If <code>era</code> is not specified, the factor will
use the entire time series for the factor.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-11">Returns<a class="anchor" aria-label="anchor" href="#returns-11"></a></h4>
<p>If <code>era</code> is a single vector or <code>NULL</code>, a factor with a length
equal to the number of offsets in this instance. If <code>era</code> is a list, a
list with the same number of elements and names as <code>era</code>, each
containing a factor. Elements in the factor will be set to <code>NA</code> for
time series values outside of the range of specified years.</p>
<p>The factor, or factors in the list, have attributes 'period', 'era' and
'CFTime'. Attribute 'period' holds the value of the <code>period</code> argument.
Attribute 'era' indicates the number of years that are included in the
era, or -1 if no <code>era</code> is provided. Attribute 'CFTime' holds an
instance of <code>CFTime</code> or <code>CFClimatology</code> that has the same definition as
this instance, but with offsets corresponding to the mid-point of the
factor levels.</p>
</div>

</div><p></p><hr><a id="method-CFTime-factor_units"></a><div class="section">
<h3 id="method-factor-units-">Method <code>factor_units()</code><a class="anchor" aria-label="anchor" href="#method-factor-units-"></a></h3>
<p>Given a factor as produced by <code>CFTime$factor()</code>, this method
will return a numeric vector with the number of time units in each
level of the factor.</p>
<p>The result of this method is useful to convert between absolute and
relative values. Climate change anomalies, for instance, are usually
computed by differencing average values between a future period and a
baseline period. Going from average values back to absolute values for
an aggregate period (which is typical for temperature and
precipitation, among other variables) is easily done with the result of
this method, without having to consider the specifics of the calendar
of the data set.</p>
<p>If the factor <code>f</code> is for an era (e.g. spanning multiple years and the
levels do not indicate the specific year), then the result will
indicate the number of time units of the period in a regular single
year. In other words, for an era of 2041-2060 and a monthly factor on a
standard calendar with a <code>days</code> unit, the result will be
<code>c(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31)</code>. Leap days are thus
only considered for the <code>366_day</code> and <code>all_leap</code> calendars.</p>
<p>Note that this function gives the number of time units in each level of
the factor - the actual number of data points in the time series per
factor level may be different. Use <code><a href="CFfactor_coverage.html">CFfactor_coverage()</a></code> to determine
the actual number of data points or the coverage of data points
relative to the factor level.</p><div class="section">
<h4 id="usage-13">Usage<a class="anchor" aria-label="anchor" href="#usage-13"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">factor_units</span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-11">Arguments<a class="anchor" aria-label="anchor" href="#arguments-11"></a></h4>
<p></p><div class="arguments"><dl><dt><code>f</code></dt>
<dd><p>A factor or a list of factors derived from the method
<code>CFTime$factor()</code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-12">Returns<a class="anchor" aria-label="anchor" href="#returns-12"></a></h4>
<p>If <code>f</code> is a factor, a numeric vector with a length equal to the
number of levels in the factor, indicating the number of time units in
each level of the factor. If <code>f</code> is a list of factors, a list with each
element a numeric vector as above.</p>
</div>

</div><p></p><hr><a id="method-CFTime-factor_coverage"></a><div class="section">
<h3 id="method-factor-coverage-">Method <code>factor_coverage()</code><a class="anchor" aria-label="anchor" href="#method-factor-coverage-"></a></h3>
<p>Calculate the number of time elements, or the relative
coverage, in each level of a factor generated by <code>CFTime$factor()</code>.</p><div class="section">
<h4 id="usage-14">Usage<a class="anchor" aria-label="anchor" href="#usage-14"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">factor_coverage</span><span class="op">(</span><span class="va">f</span>, coverage <span class="op">=</span> <span class="st">"absolute"</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-12">Arguments<a class="anchor" aria-label="anchor" href="#arguments-12"></a></h4>
<p></p><div class="arguments"><dl><dt><code>f</code></dt>
<dd><p>A factor or a list of factors derived from the method
<code>CFTime$factor()</code>.</p></dd>


<dt><code>coverage</code></dt>
<dd><p>"absolute" or "relative".</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-13">Returns<a class="anchor" aria-label="anchor" href="#returns-13"></a></h4>
<p>If <code>f</code> is a factor, a numeric vector with a length equal to the
number of levels in the factor, indicating the number of units from the
time series contained in each level of the factor when
<code>coverage = "absolute"</code> or the proportion of units present relative to the
maximum number when <code>coverage = "relative"</code>. If <code>f</code> is a list of factors, a
list with each element a numeric vector as above.</p>
</div>

</div><p></p><hr><a id="method-CFTime-copy"></a><div class="section">
<h3 id="method-copy-">Method <code>copy()</code><a class="anchor" aria-label="anchor" href="#method-copy-"></a></h3>
<p>Create a copy of the current instance. The copy is
completely separate from the current instance.</p><div class="section">
<h4 id="usage-15">Usage<a class="anchor" aria-label="anchor" href="#usage-15"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-14">Returns<a class="anchor" aria-label="anchor" href="#returns-14"></a></h4>
<p>A new <code>CFTime</code> instance with identical definition and set of
timestamps.</p>
</div>

</div><p></p><hr><a id="method-CFTime-subset"></a><div class="section">
<h3 id="method-subset-">Method <code><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset()</a></code><a class="anchor" aria-label="anchor" href="#method-subset-"></a></h3>
<p>Get a new <code>CFTime</code> instance that is a subset of the current
instance, including any boundary values.</p><div class="section">
<h4 id="usage-16">Usage<a class="anchor" aria-label="anchor" href="#usage-16"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">subset</span><span class="op">(</span><span class="va">rng</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-13">Arguments<a class="anchor" aria-label="anchor" href="#arguments-13"></a></h4>
<p></p><div class="arguments"><dl><dt><code>rng</code></dt>
<dd><p>The numeric range of indices to subset this instance to.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-15">Returns<a class="anchor" aria-label="anchor" href="#returns-15"></a></h4>
<p>A new <code>CFTime</code> instance with identical definition and set of
timestamps according to the <code>rng</code> argument.</p>
</div>

</div><p></p><hr><a id="method-CFTime-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-17">Usage<a class="anchor" aria-label="anchor" href="#usage-17"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">CFTime</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-14">Arguments<a class="anchor" aria-label="anchor" href="#arguments-14"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Van Laake.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

